实验组开始时间: 2025-02-25 19:19:25.432878
实验配置:
[
  {
    "command": "\"C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe\" train.py --model all_model --backbone cnn1d --distance_type euclidean --in_channels 5 --hidden_dim 128 --feature_dim 64 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001"
  },
  {
    "command": "\"C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe\" train.py --model all_model --backbone cnn1d --distance_type cosine --in_channels 5 --hidden_dim 128 --feature_dim 256 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001"
  },
  {
    "command": "\"C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe\" train.py --model all_model --backbone cbam --distance_type euclidean --in_channels 5 --hidden_dim 256 --feature_dim 128 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001"
  },
  {
    "command": "\"C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe\" train.py --model all_model --backbone cbam --distance_type euclidean --in_channels 5 --hidden_dim 256 --feature_dim 256 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001"
  }
]
==================================================


==================================================
执行命令: "C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe" train.py --model all_model --backbone cnn1d --distance_type euclidean --in_channels 5 --hidden_dim 128 --feature_dim 64 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001
开始时间: 2025-02-25 19:19:25.433995
==================================================

使用设备: cuda
使用模型: all_model
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

训练集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 746 个样本
类别 1: 746 个样本
类别 2: 746 个样本
类别 3: 746 个样本
类别 4: 746 个样本
类别 5: 746 个样本
类别 6: 746 个样本
类别 7: 746 个样本
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

测试集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 187 个样本
类别 1: 187 个样本
类别 2: 187 个样本
类别 3: 187 个样本
类别 4: 187 个样本
类别 5: 187 个样本
类别 6: 187 个样本
类别 7: 187 个样本

正在检查数据泄露...
数据集检查通过，未发现数据泄露。

Epoch 1/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%| | 0/25 [00:54<?, ?it/s, loss: 1.367, acc: 0.640, recall: 0.640, f1: 0.640, lr: 1.00e-06]
训练:   4%| | 1/25 [00:54<21:41, 54.24s/it, loss: 1.367, acc: 0.640, recall: 0.640, f1: 0.640, lr: 1
训练:   4%| | 1/25 [01:04<21:41, 54.24s/it, loss: 1.353, acc: 0.630, recall: 0.630, f1: 0.630, lr: 1
训练:   8%| | 2/25 [01:04<10:51, 28.31s/it, loss: 1.353, acc: 0.630, recall: 0.630, f1: 0.630, lr: 1
训练:   8%| | 2/25 [01:13<10:51, 28.31s/it, loss: 1.375, acc: 0.715, recall: 0.715, f1: 0.715, lr: 1
训练:  12%| | 3/25 [01:13<07:07, 19.43s/it, loss: 1.375, acc: 0.715, recall: 0.715, f1: 0.715, lr: 1
训练:  12%| | 3/25 [01:22<07:07, 19.43s/it, loss: 1.351, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1
训练:  16%|▏| 4/25 [01:22<05:21, 15.31s/it, loss: 1.351, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1
训练:  16%|▏| 4/25 [01:31<05:21, 15.31s/it, loss: 1.362, acc: 0.685, recall: 0.685, f1: 0.685, lr: 1
训练:  20%|▏| 5/25 [01:31<04:21, 13.07s/it, loss: 1.362, acc: 0.685, recall: 0.685, f1: 0.685, lr: 1
训练:  20%|▏| 5/25 [01:41<04:21, 13.07s/it, loss: 1.337, acc: 0.700, recall: 0.700, f1: 0.700, lr: 1
训练:  24%|▏| 6/25 [01:41<03:46, 11.93s/it, loss: 1.337, acc: 0.700, recall: 0.700, f1: 0.700, lr: 1
训练:  24%|▏| 6/25 [01:50<03:46, 11.93s/it, loss: 1.352, acc: 0.670, recall: 0.670, f1: 0.670, lr: 1
训练:  28%|▎| 7/25 [01:50<03:21, 11.17s/it, loss: 1.352, acc: 0.670, recall: 0.670, f1: 0.670, lr: 1
训练:  28%|▎| 7/25 [02:00<03:21, 11.17s/it, loss: 1.344, acc: 0.680, recall: 0.680, f1: 0.680, lr: 1
训练:  32%|▎| 8/25 [02:00<03:01, 10.65s/it, loss: 1.344, acc: 0.680, recall: 0.680, f1: 0.680, lr: 1
训练:  32%|▎| 8/25 [02:10<03:01, 10.65s/it, loss: 1.361, acc: 0.715, recall: 0.715, f1: 0.715, lr: 1
训练:  36%|▎| 9/25 [02:10<02:46, 10.38s/it, loss: 1.361, acc: 0.715, recall: 0.715, f1: 0.715, lr: 1
训练:  36%|▎| 9/25 [02:19<02:46, 10.38s/it, loss: 1.341, acc: 0.690, recall: 0.690, f1: 0.690, lr: 1
训练:  40%|▍| 10/25 [02:19<02:32, 10.18s/it, loss: 1.341, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  40%|▍| 10/25 [02:30<02:32, 10.18s/it, loss: 1.331, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练:  44%|▍| 11/25 [02:30<02:23, 10.24s/it, loss: 1.331, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练:  44%|▍| 11/25 [02:40<02:23, 10.24s/it, loss: 1.344, acc: 0.660, recall: 0.660, f1: 0.660, lr: 
训练:  48%|▍| 12/25 [02:40<02:13, 10.24s/it, loss: 1.344, acc: 0.660, recall: 0.660, f1: 0.660, lr: 
训练:  48%|▍| 12/25 [02:50<02:13, 10.24s/it, loss: 1.340, acc: 0.705, recall: 0.705, f1: 0.705, lr: 
训练:  52%|▌| 13/25 [02:50<02:03, 10.25s/it, loss: 1.340, acc: 0.705, recall: 0.705, f1: 0.705, lr: 
训练:  52%|▌| 13/25 [03:00<02:03, 10.25s/it, loss: 1.337, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  56%|▌| 14/25 [03:00<01:52, 10.21s/it, loss: 1.337, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  56%|▌| 14/25 [03:10<01:52, 10.21s/it, loss: 1.333, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练:  60%|▌| 15/25 [03:10<01:39,  9.96s/it, loss: 1.333, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练:  60%|▌| 15/25 [03:19<01:39,  9.96s/it, loss: 1.343, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  64%|▋| 16/25 [03:19<01:27,  9.71s/it, loss: 1.343, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  64%|▋| 16/25 [03:28<01:27,  9.71s/it, loss: 1.326, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  68%|▋| 17/25 [03:28<01:16,  9.51s/it, loss: 1.326, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  68%|▋| 17/25 [03:37<01:16,  9.51s/it, loss: 1.331, acc: 0.730, recall: 0.730, f1: 0.730, lr: 
训练:  72%|▋| 18/25 [03:37<01:05,  9.39s/it, loss: 1.331, acc: 0.730, recall: 0.730, f1: 0.730, lr: 
训练:  72%|▋| 18/25 [03:46<01:05,  9.39s/it, loss: 1.357, acc: 0.625, recall: 0.625, f1: 0.625, lr: 
训练:  76%|▊| 19/25 [03:46<00:55,  9.32s/it, loss: 1.357, acc: 0.625, recall: 0.625, f1: 0.625, lr: 
训练:  76%|▊| 19/25 [03:55<00:55,  9.32s/it, loss: 1.347, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  80%|▊| 20/25 [03:55<00:46,  9.24s/it, loss: 1.347, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  80%|▊| 20/25 [04:04<00:46,  9.24s/it, loss: 1.353, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  84%|▊| 21/25 [04:04<00:36,  9.19s/it, loss: 1.353, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  84%|▊| 21/25 [04:13<00:36,  9.19s/it, loss: 1.338, acc: 0.685, recall: 0.685, f1: 0.685, lr: 
训练:  88%|▉| 22/25 [04:13<00:27,  9.22s/it, loss: 1.338, acc: 0.685, recall: 0.685, f1: 0.685, lr: 
训练:  88%|▉| 22/25 [04:23<00:27,  9.22s/it, loss: 1.354, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  92%|▉| 23/25 [04:23<00:18,  9.17s/it, loss: 1.354, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  92%|▉| 23/25 [04:32<00:18,  9.17s/it, loss: 1.341, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练:  96%|▉| 24/25 [04:32<00:09,  9.14s/it, loss: 1.341, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练:  96%|▉| 24/25 [04:41<00:09,  9.14s/it, loss: 1.331, acc: 0.765, recall: 0.765, f1: 0.765, lr: 
训练: 100%|█| 25/25 [04:41<00:00,  9.13s/it, loss: 1.331, acc: 0.765, recall: 0.765, f1: 0.765, lr: 
训练: 100%|█| 25/25 [04:43<00:00, 11.36s/it, loss: 1.331, acc: 0.765, recall: 0.765, f1: 0.765, lr: 
训练集 - 损失: 1.3460, 准确率: 0.6920, 召回率: 0.6920, F1分数: 0.6920

评估:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
评估:   0%|               | 0/25 [00:21<?, ?it/s, loss: 1.285, acc: 0.850, recall: 0.850, f1: 0.850]
评估:   4%|▎      | 1/25 [00:21<08:27, 21.15s/it, loss: 1.285, acc: 0.850, recall: 0.850, f1: 0.850]
评估:   4%|▎      | 1/25 [00:21<08:27, 21.15s/it, loss: 1.343, acc: 0.765, recall: 0.765, f1: 0.765]
评估:   8%|▌      | 2/25 [00:21<03:22,  8.79s/it, loss: 1.343, acc: 0.765, recall: 0.765, f1: 0.765]
评估:   8%|▌      | 2/25 [00:21<03:22,  8.79s/it, loss: 1.354, acc: 0.770, recall: 0.770, f1: 0.770]
评估:  12%|▊      | 3/25 [00:21<01:47,  4.87s/it, loss: 1.354, acc: 0.770, recall: 0.770, f1: 0.770]
评估:  12%|▊      | 3/25 [00:21<01:47,  4.87s/it, loss: 1.291, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  16%|█      | 4/25 [00:21<01:03,  3.04s/it, loss: 1.291, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  16%|█      | 4/25 [00:22<01:03,  3.04s/it, loss: 1.332, acc: 0.800, recall: 0.800, f1: 0.800]
评估:  20%|█▍     | 5/25 [00:22<00:41,  2.06s/it, loss: 1.332, acc: 0.800, recall: 0.800, f1: 0.800]
评估:  20%|█▍     | 5/25 [00:22<00:41,  2.06s/it, loss: 1.330, acc: 0.800, recall: 0.800, f1: 0.800]
评估:  24%|█▋     | 6/25 [00:22<00:27,  1.45s/it, loss: 1.330, acc: 0.800, recall: 0.800, f1: 0.800]
评估:  24%|█▋     | 6/25 [00:22<00:27,  1.45s/it, loss: 1.365, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  28%|█▉     | 7/25 [00:22<00:19,  1.08s/it, loss: 1.365, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  28%|█▉     | 7/25 [00:22<00:19,  1.08s/it, loss: 1.306, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  32%|██▏    | 8/25 [00:22<00:13,  1.24it/s, loss: 1.306, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  32%|██▏    | 8/25 [00:23<00:13,  1.24it/s, loss: 1.310, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  36%|██▌    | 9/25 [00:23<00:09,  1.66it/s, loss: 1.310, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  36%|██▌    | 9/25 [00:23<00:09,  1.66it/s, loss: 1.345, acc: 0.660, recall: 0.660, f1: 0.660]
评估:  40%|██▍   | 10/25 [00:23<00:06,  2.15it/s, loss: 1.345, acc: 0.660, recall: 0.660, f1: 0.660]
评估:  40%|██▍   | 10/25 [00:23<00:06,  2.15it/s, loss: 1.314, acc: 0.760, recall: 0.760, f1: 0.760]
评估:  44%|██▋   | 11/25 [00:23<00:05,  2.61it/s, loss: 1.314, acc: 0.760, recall: 0.760, f1: 0.760]
评估:  44%|██▋   | 11/25 [00:23<00:05,  2.61it/s, loss: 1.333, acc: 0.635, recall: 0.635, f1: 0.635]
评估:  48%|██▉   | 12/25 [00:23<00:04,  3.13it/s, loss: 1.333, acc: 0.635, recall: 0.635, f1: 0.635]
评估:  48%|██▉   | 12/25 [00:23<00:04,  3.13it/s, loss: 1.325, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  52%|███   | 13/25 [00:23<00:03,  3.58it/s, loss: 1.325, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  52%|███   | 13/25 [00:23<00:03,  3.58it/s, loss: 1.296, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  56%|███▎  | 14/25 [00:23<00:02,  4.10it/s, loss: 1.296, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  56%|███▎  | 14/25 [00:24<00:02,  4.10it/s, loss: 1.317, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  60%|███▌  | 15/25 [00:24<00:02,  4.54it/s, loss: 1.317, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  60%|███▌  | 15/25 [00:24<00:02,  4.54it/s, loss: 1.299, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  64%|███▊  | 16/25 [00:24<00:01,  5.01it/s, loss: 1.299, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  64%|███▊  | 16/25 [00:24<00:01,  5.01it/s, loss: 1.327, acc: 0.705, recall: 0.705, f1: 0.705]
评估:  68%|████  | 17/25 [00:24<00:01,  5.40it/s, loss: 1.327, acc: 0.705, recall: 0.705, f1: 0.705]
评估:  68%|████  | 17/25 [00:24<00:01,  5.40it/s, loss: 1.353, acc: 0.675, recall: 0.675, f1: 0.675]
评估:  72%|████▎ | 18/25 [00:24<00:01,  5.54it/s, loss: 1.353, acc: 0.675, recall: 0.675, f1: 0.675]
评估:  72%|████▎ | 18/25 [00:24<00:01,  5.54it/s, loss: 1.358, acc: 0.615, recall: 0.615, f1: 0.615]
评估:  76%|████▌ | 19/25 [00:24<00:01,  5.17it/s, loss: 1.358, acc: 0.615, recall: 0.615, f1: 0.615]
评估:  76%|████▌ | 19/25 [00:24<00:01,  5.17it/s, loss: 1.327, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  80%|████▊ | 20/25 [00:24<00:00,  5.45it/s, loss: 1.327, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  80%|████▊ | 20/25 [00:25<00:00,  5.45it/s, loss: 1.341, acc: 0.675, recall: 0.675, f1: 0.675]
评估:  84%|█████ | 21/25 [00:25<00:00,  5.68it/s, loss: 1.341, acc: 0.675, recall: 0.675, f1: 0.675]
评估:  84%|█████ | 21/25 [00:25<00:00,  5.68it/s, loss: 1.326, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  88%|█████▎| 22/25 [00:25<00:00,  5.81it/s, loss: 1.326, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  88%|█████▎| 22/25 [00:25<00:00,  5.81it/s, loss: 1.306, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  92%|█████▌| 23/25 [00:25<00:00,  6.02it/s, loss: 1.306, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  92%|█████▌| 23/25 [00:25<00:00,  6.02it/s, loss: 1.317, acc: 0.805, recall: 0.805, f1: 0.805]
评估:  96%|█████▊| 24/25 [00:25<00:00,  6.43it/s, loss: 1.317, acc: 0.805, recall: 0.805, f1: 0.805]
评估:  96%|█████▊| 24/25 [00:25<00:00,  6.43it/s, loss: 1.327, acc: 0.790, recall: 0.790, f1: 0.790]
评估: 100%|██████| 25/25 [00:25<00:00,  6.74it/s, loss: 1.327, acc: 0.790, recall: 0.790, f1: 0.790]
评估: 100%|██████| 25/25 [00:26<00:00,  1.06s/it, loss: 1.327, acc: 0.790, recall: 0.790, f1: 0.790]
验证集 - 损失: 1.3251, 准确率: 0.7466, 召回率: 0.7466, F1分数: 0.7466
保存最佳模型，验证准确率: 0.7466, 召回率: 0.7466, F1分数: 0.7466

Epoch 2/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%|                                                                  | 0/25 [00:04<?, ?it/s]
Traceback (most recent call last):
  File "C:\Users\hxq11\Desktop\Project\code\train.py", line 223, in <module>
    train_loss, train_acc, train_recall, train_f1 = train_epoch(model, train_loader, optimizer, device)
  File "C:\Users\hxq11\Desktop\Project\code\utils\utils.py", line 45, in train_epoch
    for batch_idx, (support_x, support_y, query_x, query_y) in enumerate(pbar):
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\tqdm\std.py", line 1181, in __iter__
    for obj in iterable:
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 327, in _Popen
    return Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
OSError: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 126, in _main
    self = reduction.pickle.load(from_parent)
_pickle.UnpicklingError: pickle data was truncated

==================================================
命令执行完成时间: 2025-02-25 19:24:58.965622
返回码: 1
==================================================


==================================================
执行命令: "C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe" train.py --model all_model --backbone cnn1d --distance_type cosine --in_channels 5 --hidden_dim 128 --feature_dim 256 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001
开始时间: 2025-02-25 19:25:00.982956
==================================================

使用设备: cuda
使用模型: all_model
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

训练集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 746 个样本
类别 1: 746 个样本
类别 2: 746 个样本
类别 3: 746 个样本
类别 4: 746 个样本
类别 5: 746 个样本
类别 6: 746 个样本
类别 7: 746 个样本
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

测试集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 187 个样本
类别 1: 187 个样本
类别 2: 187 个样本
类别 3: 187 个样本
类别 4: 187 个样本
类别 5: 187 个样本
类别 6: 187 个样本
类别 7: 187 个样本

正在检查数据泄露...
数据集检查通过，未发现数据泄露。

Epoch 1/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%| | 0/25 [00:48<?, ?it/s, loss: 1.335, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1.00e-06]
训练:   4%| | 1/25 [00:48<19:13, 48.06s/it, loss: 1.335, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1
训练:   4%| | 1/25 [00:57<19:13, 48.06s/it, loss: 1.347, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:   8%| | 2/25 [00:57<09:45, 25.45s/it, loss: 1.347, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:   8%| | 2/25 [01:07<09:45, 25.45s/it, loss: 1.316, acc: 0.715, recall: 0.715, f1: 0.715, lr: 1
训练:  12%| | 3/25 [01:07<06:40, 18.18s/it, loss: 1.316, acc: 0.715, recall: 0.715, f1: 0.715, lr: 1
训练:  12%| | 3/25 [01:16<06:40, 18.18s/it, loss: 1.326, acc: 0.670, recall: 0.670, f1: 0.670, lr: 1
训练:  16%|▏| 4/25 [01:16<05:08, 14.71s/it, loss: 1.326, acc: 0.670, recall: 0.670, f1: 0.670, lr: 1
训练:  16%|▏| 4/25 [01:25<05:08, 14.71s/it, loss: 1.326, acc: 0.670, recall: 0.670, f1: 0.670, lr: 1
训练:  20%|▏| 5/25 [01:25<04:13, 12.66s/it, loss: 1.326, acc: 0.670, recall: 0.670, f1: 0.670, lr: 1
训练:  20%|▏| 5/25 [01:34<04:13, 12.66s/it, loss: 1.304, acc: 0.740, recall: 0.740, f1: 0.740, lr: 1
训练:  24%|▏| 6/25 [01:34<03:37, 11.47s/it, loss: 1.304, acc: 0.740, recall: 0.740, f1: 0.740, lr: 1
训练:  24%|▏| 6/25 [01:44<03:37, 11.47s/it, loss: 1.304, acc: 0.745, recall: 0.745, f1: 0.745, lr: 1
训练:  28%|▎| 7/25 [01:44<03:14, 10.80s/it, loss: 1.304, acc: 0.745, recall: 0.745, f1: 0.745, lr: 1
训练:  28%|▎| 7/25 [01:53<03:14, 10.80s/it, loss: 1.321, acc: 0.750, recall: 0.750, f1: 0.750, lr: 1
训练:  32%|▎| 8/25 [01:53<02:55, 10.33s/it, loss: 1.321, acc: 0.750, recall: 0.750, f1: 0.750, lr: 1
训练:  32%|▎| 8/25 [02:02<02:55, 10.33s/it, loss: 1.322, acc: 0.770, recall: 0.770, f1: 0.770, lr: 1
训练:  36%|▎| 9/25 [02:02<02:39,  9.96s/it, loss: 1.322, acc: 0.770, recall: 0.770, f1: 0.770, lr: 1
训练:  36%|▎| 9/25 [02:11<02:39,  9.96s/it, loss: 1.329, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:  40%|▍| 10/25 [02:11<02:25,  9.72s/it, loss: 1.329, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  40%|▍| 10/25 [02:20<02:25,  9.72s/it, loss: 1.336, acc: 0.620, recall: 0.620, f1: 0.620, lr: 
训练:  44%|▍| 11/25 [02:20<02:12,  9.50s/it, loss: 1.336, acc: 0.620, recall: 0.620, f1: 0.620, lr: 
训练:  44%|▍| 11/25 [02:29<02:12,  9.50s/it, loss: 1.313, acc: 0.785, recall: 0.785, f1: 0.785, lr: 
训练:  48%|▍| 12/25 [02:29<02:01,  9.32s/it, loss: 1.313, acc: 0.785, recall: 0.785, f1: 0.785, lr: 
训练:  48%|▍| 12/25 [02:39<02:01,  9.32s/it, loss: 1.313, acc: 0.775, recall: 0.775, f1: 0.775, lr: 
训练:  52%|▌| 13/25 [02:39<01:51,  9.30s/it, loss: 1.313, acc: 0.775, recall: 0.775, f1: 0.775, lr: 
训练:  52%|▌| 13/25 [02:48<01:51,  9.30s/it, loss: 1.324, acc: 0.760, recall: 0.760, f1: 0.760, lr: 
训练:  56%|▌| 14/25 [02:48<01:41,  9.21s/it, loss: 1.324, acc: 0.760, recall: 0.760, f1: 0.760, lr: 
训练:  56%|▌| 14/25 [02:57<01:41,  9.21s/it, loss: 1.314, acc: 0.745, recall: 0.745, f1: 0.745, lr: 
训练:  60%|▌| 15/25 [02:57<01:31,  9.17s/it, loss: 1.314, acc: 0.745, recall: 0.745, f1: 0.745, lr: 
训练:  60%|▌| 15/25 [03:06<01:31,  9.17s/it, loss: 1.310, acc: 0.730, recall: 0.730, f1: 0.730, lr: 
训练:  64%|▋| 16/25 [03:06<01:22,  9.20s/it, loss: 1.310, acc: 0.730, recall: 0.730, f1: 0.730, lr: 
训练:  64%|▋| 16/25 [03:15<01:22,  9.20s/it, loss: 1.300, acc: 0.740, recall: 0.740, f1: 0.740, lr: 
训练:  68%|▋| 17/25 [03:15<01:13,  9.15s/it, loss: 1.300, acc: 0.740, recall: 0.740, f1: 0.740, lr: 
训练:  68%|▋| 17/25 [03:24<01:13,  9.15s/it, loss: 1.296, acc: 0.750, recall: 0.750, f1: 0.750, lr: 
训练:  72%|▋| 18/25 [03:24<01:03,  9.08s/it, loss: 1.296, acc: 0.750, recall: 0.750, f1: 0.750, lr: 
训练:  72%|▋| 18/25 [03:33<01:03,  9.08s/it, loss: 1.315, acc: 0.785, recall: 0.785, f1: 0.785, lr: 
训练:  76%|▊| 19/25 [03:33<00:54,  9.09s/it, loss: 1.315, acc: 0.785, recall: 0.785, f1: 0.785, lr: 
训练:  76%|▊| 19/25 [03:42<00:54,  9.09s/it, loss: 1.312, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  80%|▊| 20/25 [03:42<00:45,  9.08s/it, loss: 1.312, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  80%|▊| 20/25 [03:51<00:45,  9.08s/it, loss: 1.334, acc: 0.735, recall: 0.735, f1: 0.735, lr: 
训练:  84%|▊| 21/25 [03:51<00:36,  9.06s/it, loss: 1.334, acc: 0.735, recall: 0.735, f1: 0.735, lr: 
训练:  84%|▊| 21/25 [04:00<00:36,  9.06s/it, loss: 1.286, acc: 0.725, recall: 0.725, f1: 0.725, lr: 
训练:  88%|▉| 22/25 [04:00<00:27,  9.04s/it, loss: 1.286, acc: 0.725, recall: 0.725, f1: 0.725, lr: 
训练:  88%|▉| 22/25 [04:09<00:27,  9.04s/it, loss: 1.284, acc: 0.750, recall: 0.750, f1: 0.750, lr: 
训练:  92%|▉| 23/25 [04:09<00:18,  9.10s/it, loss: 1.284, acc: 0.750, recall: 0.750, f1: 0.750, lr: 
训练:  92%|▉| 23/25 [04:18<00:18,  9.10s/it, loss: 1.284, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  96%|▉| 24/25 [04:18<00:09,  9.06s/it, loss: 1.284, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  96%|▉| 24/25 [04:27<00:09,  9.06s/it, loss: 1.298, acc: 0.635, recall: 0.635, f1: 0.635, lr: 
训练: 100%|█| 25/25 [04:27<00:00,  9.03s/it, loss: 1.298, acc: 0.635, recall: 0.635, f1: 0.635, lr: 
训练: 100%|█| 25/25 [04:31<00:00, 10.86s/it, loss: 1.298, acc: 0.635, recall: 0.635, f1: 0.635, lr: 
训练集 - 损失: 1.3139, 准确率: 0.7224, 召回率: 0.7224, F1分数: 0.7224

评估:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
评估:   0%|               | 0/25 [00:21<?, ?it/s, loss: 1.453, acc: 0.765, recall: 0.765, f1: 0.765]
评估:   4%|▎      | 1/25 [00:21<08:26, 21.09s/it, loss: 1.453, acc: 0.765, recall: 0.765, f1: 0.765]
评估:   4%|▎      | 1/25 [00:21<08:26, 21.09s/it, loss: 1.447, acc: 0.755, recall: 0.755, f1: 0.755]
评估:   8%|▌      | 2/25 [00:21<03:21,  8.77s/it, loss: 1.447, acc: 0.755, recall: 0.755, f1: 0.755]
评估:   8%|▌      | 2/25 [00:21<03:21,  8.77s/it, loss: 1.417, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  12%|▊      | 3/25 [00:21<01:46,  4.84s/it, loss: 1.417, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  12%|▊      | 3/25 [00:21<01:46,  4.84s/it, loss: 1.451, acc: 0.690, recall: 0.690, f1: 0.690]
评估:  16%|█      | 4/25 [00:21<01:02,  2.99s/it, loss: 1.451, acc: 0.690, recall: 0.690, f1: 0.690]
评估:  16%|█      | 4/25 [00:21<01:02,  2.99s/it, loss: 1.439, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  20%|█▍     | 5/25 [00:21<00:39,  1.97s/it, loss: 1.439, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  20%|█▍     | 5/25 [00:21<00:39,  1.97s/it, loss: 1.422, acc: 0.705, recall: 0.705, f1: 0.705]
评估:  24%|█▋     | 6/25 [00:21<00:25,  1.35s/it, loss: 1.422, acc: 0.705, recall: 0.705, f1: 0.705]
评估:  24%|█▋     | 6/25 [00:22<00:25,  1.35s/it, loss: 1.435, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  28%|█▉     | 7/25 [00:22<00:17,  1.05it/s, loss: 1.435, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  28%|█▉     | 7/25 [00:22<00:17,  1.05it/s, loss: 1.461, acc: 0.815, recall: 0.815, f1: 0.815]
评估:  32%|██▏    | 8/25 [00:22<00:12,  1.32it/s, loss: 1.461, acc: 0.815, recall: 0.815, f1: 0.815]
评估:  32%|██▏    | 8/25 [00:22<00:12,  1.32it/s, loss: 1.395, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  36%|██▌    | 9/25 [00:22<00:09,  1.63it/s, loss: 1.395, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  36%|██▌    | 9/25 [00:22<00:09,  1.63it/s, loss: 1.438, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  40%|██▍   | 10/25 [00:22<00:07,  2.10it/s, loss: 1.438, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  40%|██▍   | 10/25 [00:22<00:07,  2.10it/s, loss: 1.454, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  44%|██▋   | 11/25 [00:22<00:05,  2.67it/s, loss: 1.454, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  44%|██▋   | 11/25 [00:23<00:05,  2.67it/s, loss: 1.429, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  48%|██▉   | 12/25 [00:23<00:03,  3.26it/s, loss: 1.429, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  48%|██▉   | 12/25 [00:23<00:03,  3.26it/s, loss: 1.438, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  52%|███   | 13/25 [00:23<00:03,  3.87it/s, loss: 1.438, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  52%|███   | 13/25 [00:23<00:03,  3.87it/s, loss: 1.442, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  56%|███▎  | 14/25 [00:23<00:02,  4.53it/s, loss: 1.442, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  56%|███▎  | 14/25 [00:23<00:02,  4.53it/s, loss: 1.455, acc: 0.685, recall: 0.685, f1: 0.685]
评估:  60%|███▌  | 15/25 [00:23<00:01,  5.10it/s, loss: 1.455, acc: 0.685, recall: 0.685, f1: 0.685]
评估:  60%|███▌  | 15/25 [00:23<00:01,  5.10it/s, loss: 1.448, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  64%|███▊  | 16/25 [00:23<00:01,  5.36it/s, loss: 1.448, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  64%|███▊  | 16/25 [00:23<00:01,  5.36it/s, loss: 1.436, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  68%|████  | 17/25 [00:23<00:01,  5.82it/s, loss: 1.436, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  68%|████  | 17/25 [00:23<00:01,  5.82it/s, loss: 1.468, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  72%|████▎ | 18/25 [00:23<00:01,  6.14it/s, loss: 1.468, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  72%|████▎ | 18/25 [00:24<00:01,  6.14it/s, loss: 1.424, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  76%|████▌ | 19/25 [00:24<00:01,  5.83it/s, loss: 1.424, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  76%|████▌ | 19/25 [00:24<00:01,  5.83it/s, loss: 1.482, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  80%|████▊ | 20/25 [00:24<00:00,  5.88it/s, loss: 1.482, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  80%|████▊ | 20/25 [00:24<00:00,  5.88it/s, loss: 1.406, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  84%|█████ | 21/25 [00:24<00:00,  5.89it/s, loss: 1.406, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  84%|█████ | 21/25 [00:24<00:00,  5.89it/s, loss: 1.484, acc: 0.690, recall: 0.690, f1: 0.690]
评估:  88%|█████▎| 22/25 [00:24<00:00,  6.29it/s, loss: 1.484, acc: 0.690, recall: 0.690, f1: 0.690]
评估:  88%|█████▎| 22/25 [00:24<00:00,  6.29it/s, loss: 1.449, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  92%|█████▌| 23/25 [00:24<00:00,  6.66it/s, loss: 1.449, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  92%|█████▌| 23/25 [00:24<00:00,  6.66it/s, loss: 1.442, acc: 0.735, recall: 0.735, f1: 0.735]
评估:  96%|█████▊| 24/25 [00:24<00:00,  6.90it/s, loss: 1.442, acc: 0.735, recall: 0.735, f1: 0.735]
评估:  96%|█████▊| 24/25 [00:25<00:00,  6.90it/s, loss: 1.438, acc: 0.810, recall: 0.810, f1: 0.810]
评估: 100%|██████| 25/25 [00:25<00:00,  6.80it/s, loss: 1.438, acc: 0.810, recall: 0.810, f1: 0.810]
评估: 100%|██████| 25/25 [00:25<00:00,  1.04s/it, loss: 1.438, acc: 0.810, recall: 0.810, f1: 0.810]
验证集 - 损失: 1.4422, 准确率: 0.7416, 召回率: 0.7416, F1分数: 0.7416
保存最佳模型，验证准确率: 0.7416, 召回率: 0.7416, F1分数: 0.7416

Epoch 2/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%| | 0/25 [00:46<?, ?it/s, loss: 1.313, acc: 0.665, recall: 0.665, f1: 0.665, lr: 2.01e-04]
训练:   4%| | 1/25 [00:46<18:45, 46.88s/it, loss: 1.313, acc: 0.665, recall: 0.665, f1: 0.665, lr: 2
训练:   4%| | 1/25 [00:56<18:45, 46.88s/it, loss: 1.268, acc: 0.710, recall: 0.710, f1: 0.710, lr: 2
训练:   8%| | 2/25 [00:56<09:28, 24.71s/it, loss: 1.268, acc: 0.710, recall: 0.710, f1: 0.710, lr: 2
训练:   8%| | 2/25 [01:05<09:28, 24.71s/it, loss: 1.280, acc: 0.650, recall: 0.650, f1: 0.650, lr: 2
训练:  12%| | 3/25 [01:05<06:28, 17.64s/it, loss: 1.280, acc: 0.650, recall: 0.650, f1: 0.650, lr: 2
训练:  12%| | 3/25 [01:14<06:28, 17.64s/it, loss: 1.224, acc: 0.725, recall: 0.725, f1: 0.725, lr: 2
训练:  16%|▏| 4/25 [01:14<04:59, 14.27s/it, loss: 1.224, acc: 0.725, recall: 0.725, f1: 0.725, lr: 2
训练:  16%|▏| 4/25 [01:23<04:59, 14.27s/it, loss: 1.245, acc: 0.775, recall: 0.775, f1: 0.775, lr: 2
训练:  20%|▏| 5/25 [01:23<04:07, 12.38s/it, loss: 1.245, acc: 0.775, recall: 0.775, f1: 0.775, lr: 2
训练:  20%|▏| 5/25 [01:32<04:07, 12.38s/it, loss: 1.275, acc: 0.710, recall: 0.710, f1: 0.710, lr: 2
训练:  24%|▏| 6/25 [01:32<03:36, 11.40s/it, loss: 1.275, acc: 0.710, recall: 0.710, f1: 0.710, lr: 2
训练:  24%|▏| 6/25 [01:44<03:36, 11.40s/it, loss: 1.223, acc: 0.710, recall: 0.710, f1: 0.710, lr: 2
训练:  28%|▎| 7/25 [01:44<03:24, 11.37s/it, loss: 1.223, acc: 0.710, recall: 0.710, f1: 0.710, lr: 2
训练:  28%|▎| 7/25 [01:55<03:24, 11.37s/it, loss: 1.249, acc: 0.680, recall: 0.680, f1: 0.680, lr: 2
训练:  32%|▎| 8/25 [01:55<03:12, 11.34s/it, loss: 1.249, acc: 0.680, recall: 0.680, f1: 0.680, lr: 2
训练:  32%|▎| 8/25 [02:06<03:12, 11.34s/it, loss: 1.224, acc: 0.670, recall: 0.670, f1: 0.670, lr: 2
训练:  36%|▎| 9/25 [02:06<02:58, 11.16s/it, loss: 1.224, acc: 0.670, recall: 0.670, f1: 0.670, lr: 2
训练:  36%|▎| 9/25 [02:17<02:58, 11.16s/it, loss: 1.201, acc: 0.700, recall: 0.700, f1: 0.700, lr: 2
训练:  40%|▍| 10/25 [02:17<02:46, 11.09s/it, loss: 1.201, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  40%|▍| 10/25 [02:27<02:46, 11.09s/it, loss: 1.279, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练:  44%|▍| 11/25 [02:27<02:29, 10.71s/it, loss: 1.279, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练:  44%|▍| 11/25 [02:38<02:29, 10.71s/it, loss: 1.222, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  48%|▍| 12/25 [02:38<02:20, 10.84s/it, loss: 1.222, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  48%|▍| 12/25 [02:50<02:20, 10.84s/it, loss: 1.251, acc: 0.625, recall: 0.625, f1: 0.625, lr: 
训练:  52%|▌| 13/25 [02:50<02:16, 11.34s/it, loss: 1.251, acc: 0.625, recall: 0.625, f1: 0.625, lr: 
训练:  52%|▌| 13/25 [03:03<02:16, 11.34s/it, loss: 1.221, acc: 0.590, recall: 0.590, f1: 0.590, lr: 
训练:  56%|▌| 14/25 [03:03<02:08, 11.64s/it, loss: 1.221, acc: 0.590, recall: 0.590, f1: 0.590, lr: 
训练:  56%|▌| 14/25 [03:12<02:08, 11.64s/it, loss: 1.264, acc: 0.620, recall: 0.620, f1: 0.620, lr: 
训练:  60%|▌| 15/25 [03:12<01:51, 11.12s/it, loss: 1.264, acc: 0.620, recall: 0.620, f1: 0.620, lr: 
训练:  60%|▌| 15/25 [03:22<01:51, 11.12s/it, loss: 1.208, acc: 0.750, recall: 0.750, f1: 0.750, lr: 
训练:  64%|▋| 16/25 [03:22<01:35, 10.63s/it, loss: 1.208, acc: 0.750, recall: 0.750, f1: 0.750, lr: 
训练:  64%|▋| 16/25 [03:32<01:35, 10.63s/it, loss: 1.277, acc: 0.550, recall: 0.550, f1: 0.550, lr: 
训练:  68%|▋| 17/25 [03:32<01:23, 10.47s/it, loss: 1.277, acc: 0.550, recall: 0.550, f1: 0.550, lr: 
训练:  68%|▋| 17/25 [03:42<01:23, 10.47s/it, loss: 1.201, acc: 0.660, recall: 0.660, f1: 0.660, lr: 
训练:  72%|▋| 18/25 [03:42<01:11, 10.23s/it, loss: 1.201, acc: 0.660, recall: 0.660, f1: 0.660, lr: 
训练:  72%|▋| 18/25 [03:52<01:11, 10.23s/it, loss: 1.221, acc: 0.620, recall: 0.620, f1: 0.620, lr: 
训练:  76%|▊| 19/25 [03:52<01:00, 10.14s/it, loss: 1.221, acc: 0.620, recall: 0.620, f1: 0.620, lr: 
训练:  76%|▊| 19/25 [04:02<01:00, 10.14s/it, loss: 1.191, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  80%|▊| 20/25 [04:02<00:50, 10.10s/it, loss: 1.191, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  80%|▊| 20/25 [04:11<00:50, 10.10s/it, loss: 1.216, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  84%|▊| 21/25 [04:11<00:39,  9.96s/it, loss: 1.216, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  84%|▊| 21/25 [04:21<00:39,  9.96s/it, loss: 1.210, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  88%|▉| 22/25 [04:21<00:29,  9.83s/it, loss: 1.210, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  88%|▉| 22/25 [04:30<00:29,  9.83s/it, loss: 1.203, acc: 0.645, recall: 0.645, f1: 0.645, lr: 
训练:  92%|▉| 23/25 [04:30<00:19,  9.72s/it, loss: 1.203, acc: 0.645, recall: 0.645, f1: 0.645, lr: 
训练:  92%|▉| 23/25 [04:40<00:19,  9.72s/it, loss: 1.186, acc: 0.605, recall: 0.605, f1: 0.605, lr: 
训练:  96%|▉| 24/25 [04:40<00:09,  9.69s/it, loss: 1.186, acc: 0.605, recall: 0.605, f1: 0.605, lr: 
训练:  96%|▉| 24/25 [04:49<00:09,  9.69s/it, loss: 1.190, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练: 100%|█| 25/25 [04:49<00:00,  9.66s/it, loss: 1.190, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练: 100%|█| 25/25 [04:53<00:00, 11.74s/it, loss: 1.190, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练集 - 损失: 1.2337, 准确率: 0.6708, 召回率: 0.6708, F1分数: 0.6708

评估:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
评估:   0%|               | 0/25 [00:22<?, ?it/s, loss: 1.186, acc: 0.735, recall: 0.735, f1: 0.735]
评估:   4%|▎      | 1/25 [00:22<09:06, 22.76s/it, loss: 1.186, acc: 0.735, recall: 0.735, f1: 0.735]
评估:   4%|▎      | 1/25 [00:22<09:06, 22.76s/it, loss: 1.151, acc: 0.800, recall: 0.800, f1: 0.800]
评估:   8%|▌      | 2/25 [00:22<03:37,  9.47s/it, loss: 1.151, acc: 0.800, recall: 0.800, f1: 0.800]
评估:   8%|▌      | 2/25 [00:23<03:37,  9.47s/it, loss: 1.177, acc: 0.810, recall: 0.810, f1: 0.810]
评估:  12%|▊      | 3/25 [00:23<01:54,  5.22s/it, loss: 1.177, acc: 0.810, recall: 0.810, f1: 0.810]
评估:  12%|▊      | 3/25 [00:23<01:54,  5.22s/it, loss: 1.157, acc: 0.830, recall: 0.830, f1: 0.830]
评估:  16%|█      | 4/25 [00:23<01:08,  3.26s/it, loss: 1.157, acc: 0.830, recall: 0.830, f1: 0.830]
评估:  16%|█      | 4/25 [00:23<01:08,  3.26s/it, loss: 1.137, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  20%|█▍     | 5/25 [00:23<00:43,  2.17s/it, loss: 1.137, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  20%|█▍     | 5/25 [00:23<00:43,  2.17s/it, loss: 1.188, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  24%|█▋     | 6/25 [00:23<00:29,  1.55s/it, loss: 1.188, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  24%|█▋     | 6/25 [00:24<00:29,  1.55s/it, loss: 1.192, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  28%|█▉     | 7/25 [00:24<00:20,  1.13s/it, loss: 1.192, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  28%|█▉     | 7/25 [00:24<00:20,  1.13s/it, loss: 1.136, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  32%|██▏    | 8/25 [00:24<00:14,  1.16it/s, loss: 1.136, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  32%|██▏    | 8/25 [00:24<00:14,  1.16it/s, loss: 1.156, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  36%|██▌    | 9/25 [00:24<00:10,  1.54it/s, loss: 1.156, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  36%|██▌    | 9/25 [00:24<00:10,  1.54it/s, loss: 1.144, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  40%|██▍   | 10/25 [00:24<00:07,  2.01it/s, loss: 1.144, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  40%|██▍   | 10/25 [00:24<00:07,  2.01it/s, loss: 1.213, acc: 0.740, recall: 0.740, f1: 0.740]
评估:  44%|██▋   | 11/25 [00:24<00:05,  2.56it/s, loss: 1.213, acc: 0.740, recall: 0.740, f1: 0.740]
评估:  44%|██▋   | 11/25 [00:25<00:05,  2.56it/s, loss: 1.140, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  48%|██▉   | 12/25 [00:25<00:04,  3.11it/s, loss: 1.140, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  48%|██▉   | 12/25 [00:25<00:04,  3.11it/s, loss: 1.177, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  52%|███   | 13/25 [00:25<00:03,  3.61it/s, loss: 1.177, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  52%|███   | 13/25 [00:25<00:03,  3.61it/s, loss: 1.149, acc: 0.795, recall: 0.795, f1: 0.795]
评估:  56%|███▎  | 14/25 [00:25<00:02,  4.17it/s, loss: 1.149, acc: 0.795, recall: 0.795, f1: 0.795]
评估:  56%|███▎  | 14/25 [00:25<00:02,  4.17it/s, loss: 1.164, acc: 0.805, recall: 0.805, f1: 0.805]
评估:  60%|███▌  | 15/25 [00:25<00:02,  4.67it/s, loss: 1.164, acc: 0.805, recall: 0.805, f1: 0.805]
评估:  60%|███▌  | 15/25 [00:25<00:02,  4.67it/s, loss: 1.152, acc: 0.795, recall: 0.795, f1: 0.795]
评估:  64%|███▊  | 16/25 [00:25<00:01,  5.21it/s, loss: 1.152, acc: 0.795, recall: 0.795, f1: 0.795]
评估:  64%|███▊  | 16/25 [00:25<00:01,  5.21it/s, loss: 1.122, acc: 0.855, recall: 0.855, f1: 0.855]
评估:  68%|████  | 17/25 [00:25<00:01,  5.68it/s, loss: 1.122, acc: 0.855, recall: 0.855, f1: 0.855]
评估:  68%|████  | 17/25 [00:26<00:01,  5.68it/s, loss: 1.152, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  72%|████▎ | 18/25 [00:26<00:01,  6.02it/s, loss: 1.152, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  72%|████▎ | 18/25 [00:26<00:01,  6.02it/s, loss: 1.139, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  76%|████▌ | 19/25 [00:26<00:00,  6.32it/s, loss: 1.139, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  76%|████▌ | 19/25 [00:26<00:00,  6.32it/s, loss: 1.135, acc: 0.845, recall: 0.845, f1: 0.845]
评估:  80%|████▊ | 20/25 [00:26<00:00,  6.39it/s, loss: 1.135, acc: 0.845, recall: 0.845, f1: 0.845]
评估:  80%|████▊ | 20/25 [00:26<00:00,  6.39it/s, loss: 1.145, acc: 0.785, recall: 0.785, f1: 0.785]
评估:  84%|█████ | 21/25 [00:26<00:00,  6.38it/s, loss: 1.145, acc: 0.785, recall: 0.785, f1: 0.785]
评估:  84%|█████ | 21/25 [00:26<00:00,  6.38it/s, loss: 1.167, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  88%|█████▎| 22/25 [00:26<00:00,  6.37it/s, loss: 1.167, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  88%|█████▎| 22/25 [00:26<00:00,  6.37it/s, loss: 1.178, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  92%|█████▌| 23/25 [00:26<00:00,  6.33it/s, loss: 1.178, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  92%|█████▌| 23/25 [00:26<00:00,  6.33it/s, loss: 1.179, acc: 0.830, recall: 0.830, f1: 0.830]
评估:  96%|█████▊| 24/25 [00:26<00:00,  6.56it/s, loss: 1.179, acc: 0.830, recall: 0.830, f1: 0.830]
评估:  96%|█████▊| 24/25 [00:27<00:00,  6.56it/s, loss: 1.165, acc: 0.725, recall: 0.725, f1: 0.725]
评估: 100%|██████| 25/25 [00:27<00:00,  6.74it/s, loss: 1.165, acc: 0.725, recall: 0.725, f1: 0.725]
评估: 100%|██████| 25/25 [00:27<00:00,  1.11s/it, loss: 1.165, acc: 0.725, recall: 0.725, f1: 0.725]
验证集 - 损失: 1.1600, 准确率: 0.7788, 召回率: 0.7788, F1分数: 0.7788
保存最佳模型，验证准确率: 0.7788, 召回率: 0.7788, F1分数: 0.7788

Epoch 3/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%|                                                                  | 0/25 [00:18<?, ?it/s]
Traceback (most recent call last):
  File "C:\Users\hxq11\Desktop\Project\code\train.py", line 223, in <module>
    train_loss, train_acc, train_recall, train_f1 = train_epoch(model, train_loader, optimizer, device)
  File "C:\Users\hxq11\Desktop\Project\code\utils\utils.py", line 45, in train_epoch
    for batch_idx, (support_x, support_y, query_x, query_y) in enumerate(pbar):
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\tqdm\std.py", line 1181, in __iter__
    for obj in iterable:
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 327, in _Popen
    return Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
OSError: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 126, in _main
    self = reduction.pickle.load(from_parent)
_pickle.UnpicklingError: pickle data was truncated

==================================================
命令执行完成时间: 2025-02-25 19:35:59.604511
返回码: 1
==================================================


==================================================
执行命令: "C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe" train.py --model all_model --backbone cbam --distance_type euclidean --in_channels 5 --hidden_dim 256 --feature_dim 128 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001
开始时间: 2025-02-25 19:36:01.610247
==================================================

使用设备: cuda
使用模型: all_model
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

训练集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 746 个样本
类别 1: 746 个样本
类别 2: 746 个样本
类别 3: 746 个样本
类别 4: 746 个样本
类别 5: 746 个样本
类别 6: 746 个样本
类别 7: 746 个样本
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

测试集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 187 个样本
类别 1: 187 个样本
类别 2: 187 个样本
类别 3: 187 个样本
类别 4: 187 个样本
类别 5: 187 个样本
类别 6: 187 个样本
类别 7: 187 个样本

正在检查数据泄露...
数据集检查通过，未发现数据泄露。

Epoch 1/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%| | 0/25 [01:15<?, ?it/s, loss: 1.425, acc: 0.610, recall: 0.610, f1: 0.610, lr: 1.00e-06]
训练:   4%| | 1/25 [01:15<30:07, 75.31s/it, loss: 1.425, acc: 0.610, recall: 0.610, f1: 0.610, lr: 1
训练:   4%| | 1/25 [01:28<30:07, 75.31s/it, loss: 1.392, acc: 0.695, recall: 0.695, f1: 0.695, lr: 1
训练:   8%| | 2/25 [01:28<14:51, 38.75s/it, loss: 1.392, acc: 0.695, recall: 0.695, f1: 0.695, lr: 1
训练:   8%| | 2/25 [01:42<14:51, 38.75s/it, loss: 1.402, acc: 0.690, recall: 0.690, f1: 0.690, lr: 1
训练:  12%| | 3/25 [01:42<10:02, 27.40s/it, loss: 1.402, acc: 0.690, recall: 0.690, f1: 0.690, lr: 1
训练:  12%| | 3/25 [01:55<10:02, 27.40s/it, loss: 1.411, acc: 0.630, recall: 0.630, f1: 0.630, lr: 1
训练:  16%|▏| 4/25 [01:55<07:35, 21.71s/it, loss: 1.411, acc: 0.630, recall: 0.630, f1: 0.630, lr: 1
训练:  16%|▏| 4/25 [02:08<07:35, 21.71s/it, loss: 1.395, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:  20%|▏| 5/25 [02:08<06:09, 18.49s/it, loss: 1.395, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:  20%|▏| 5/25 [02:21<06:09, 18.49s/it, loss: 1.396, acc: 0.680, recall: 0.680, f1: 0.680, lr: 1
训练:  24%|▏| 6/25 [02:21<05:15, 16.58s/it, loss: 1.396, acc: 0.680, recall: 0.680, f1: 0.680, lr: 1
训练:  24%|▏| 6/25 [02:33<05:15, 16.58s/it, loss: 1.400, acc: 0.705, recall: 0.705, f1: 0.705, lr: 1
训练:  28%|▎| 7/25 [02:33<04:36, 15.36s/it, loss: 1.400, acc: 0.705, recall: 0.705, f1: 0.705, lr: 1
训练:  28%|▎| 7/25 [02:46<04:36, 15.36s/it, loss: 1.415, acc: 0.650, recall: 0.650, f1: 0.650, lr: 1
训练:  32%|▎| 8/25 [02:46<04:08, 14.64s/it, loss: 1.415, acc: 0.650, recall: 0.650, f1: 0.650, lr: 1
训练:  32%|▎| 8/25 [02:59<04:08, 14.64s/it, loss: 1.439, acc: 0.590, recall: 0.590, f1: 0.590, lr: 1
训练:  36%|▎| 9/25 [02:59<03:44, 14.03s/it, loss: 1.439, acc: 0.590, recall: 0.590, f1: 0.590, lr: 1
训练:  36%|▎| 9/25 [03:12<03:44, 14.03s/it, loss: 1.399, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:  40%|▍| 10/25 [03:12<03:24, 13.65s/it, loss: 1.399, acc: 0.675, recall: 0.675, f1: 0.675, lr: 
训练:  40%|▍| 10/25 [03:25<03:24, 13.65s/it, loss: 1.412, acc: 0.590, recall: 0.590, f1: 0.590, lr: 
训练:  44%|▍| 11/25 [03:25<03:07, 13.41s/it, loss: 1.412, acc: 0.590, recall: 0.590, f1: 0.590, lr: 
训练:  44%|▍| 11/25 [03:38<03:07, 13.41s/it, loss: 1.374, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  48%|▍| 12/25 [03:38<02:51, 13.20s/it, loss: 1.374, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  48%|▍| 12/25 [03:51<02:51, 13.20s/it, loss: 1.383, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  52%|▌| 13/25 [03:51<02:38, 13.19s/it, loss: 1.383, acc: 0.720, recall: 0.720, f1: 0.720, lr: 
训练:  52%|▌| 13/25 [04:04<02:38, 13.19s/it, loss: 1.380, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练:  56%|▌| 14/25 [04:04<02:23, 13.07s/it, loss: 1.380, acc: 0.715, recall: 0.715, f1: 0.715, lr: 
训练:  56%|▌| 14/25 [04:16<02:23, 13.07s/it, loss: 1.388, acc: 0.665, recall: 0.665, f1: 0.665, lr: 
训练:  60%|▌| 15/25 [04:16<02:09, 12.98s/it, loss: 1.388, acc: 0.665, recall: 0.665, f1: 0.665, lr: 
训练:  60%|▌| 15/25 [04:29<02:09, 12.98s/it, loss: 1.413, acc: 0.580, recall: 0.580, f1: 0.580, lr: 
训练:  64%|▋| 16/25 [04:29<01:56, 12.93s/it, loss: 1.413, acc: 0.580, recall: 0.580, f1: 0.580, lr: 
训练:  64%|▋| 16/25 [04:42<01:56, 12.93s/it, loss: 1.421, acc: 0.655, recall: 0.655, f1: 0.655, lr: 
训练:  68%|▋| 17/25 [04:42<01:43, 12.91s/it, loss: 1.421, acc: 0.655, recall: 0.655, f1: 0.655, lr: 
训练:  68%|▋| 17/25 [04:55<01:43, 12.91s/it, loss: 1.369, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  72%|▋| 18/25 [04:55<01:30, 12.90s/it, loss: 1.369, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  72%|▋| 18/25 [05:08<01:30, 12.90s/it, loss: 1.403, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  76%|▊| 19/25 [05:08<01:17, 12.85s/it, loss: 1.403, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  76%|▊| 19/25 [05:20<01:17, 12.85s/it, loss: 1.387, acc: 0.705, recall: 0.705, f1: 0.705, lr: 
训练:  80%|▊| 20/25 [05:20<01:04, 12.81s/it, loss: 1.387, acc: 0.705, recall: 0.705, f1: 0.705, lr: 
训练:  80%|▊| 20/25 [05:33<01:04, 12.81s/it, loss: 1.389, acc: 0.745, recall: 0.745, f1: 0.745, lr: 
训练:  84%|▊| 21/25 [05:33<00:51, 12.84s/it, loss: 1.389, acc: 0.745, recall: 0.745, f1: 0.745, lr: 
训练:  84%|▊| 21/25 [05:46<00:51, 12.84s/it, loss: 1.396, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  88%|▉| 22/25 [05:46<00:38, 12.86s/it, loss: 1.396, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  88%|▉| 22/25 [05:59<00:38, 12.86s/it, loss: 1.391, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  92%|▉| 23/25 [05:59<00:26, 13.01s/it, loss: 1.391, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  92%|▉| 23/25 [06:12<00:26, 13.01s/it, loss: 1.390, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  96%|▉| 24/25 [06:12<00:12, 12.95s/it, loss: 1.390, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  96%|▉| 24/25 [06:25<00:12, 12.95s/it, loss: 1.403, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练: 100%|█| 25/25 [06:25<00:00, 12.89s/it, loss: 1.403, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练: 100%|█| 25/25 [06:27<00:00, 15.48s/it, loss: 1.403, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练集 - 损失: 1.3990, 准确率: 0.6738, 召回率: 0.6738, F1分数: 0.6738

评估:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
评估:   0%|               | 0/25 [00:21<?, ?it/s, loss: 1.478, acc: 0.680, recall: 0.680, f1: 0.680]
评估:   4%|▎      | 1/25 [00:21<08:30, 21.29s/it, loss: 1.478, acc: 0.680, recall: 0.680, f1: 0.680]
评估:   4%|▎      | 1/25 [00:22<08:30, 21.29s/it, loss: 1.466, acc: 0.785, recall: 0.785, f1: 0.785]
评估:   8%|▌      | 2/25 [00:22<03:42,  9.67s/it, loss: 1.466, acc: 0.785, recall: 0.785, f1: 0.785]
评估:   8%|▌      | 2/25 [00:24<03:42,  9.67s/it, loss: 1.470, acc: 0.710, recall: 0.710, f1: 0.710]
评估:  12%|▊      | 3/25 [00:24<02:10,  5.95s/it, loss: 1.470, acc: 0.710, recall: 0.710, f1: 0.710]
评估:  12%|▊      | 3/25 [00:25<02:10,  5.95s/it, loss: 1.459, acc: 0.800, recall: 0.800, f1: 0.800]
评估:  16%|█      | 4/25 [00:25<01:28,  4.20s/it, loss: 1.459, acc: 0.800, recall: 0.800, f1: 0.800]
评估:  16%|█      | 4/25 [00:27<01:28,  4.20s/it, loss: 1.476, acc: 0.740, recall: 0.740, f1: 0.740]
评估:  20%|█▍     | 5/25 [00:27<01:04,  3.24s/it, loss: 1.476, acc: 0.740, recall: 0.740, f1: 0.740]
评估:  20%|█▍     | 5/25 [00:28<01:04,  3.24s/it, loss: 1.471, acc: 0.675, recall: 0.675, f1: 0.675]
评估:  24%|█▋     | 6/25 [00:28<00:50,  2.67s/it, loss: 1.471, acc: 0.675, recall: 0.675, f1: 0.675]
评估:  24%|█▋     | 6/25 [00:30<00:50,  2.67s/it, loss: 1.467, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  28%|█▉     | 7/25 [00:30<00:41,  2.29s/it, loss: 1.467, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  28%|█▉     | 7/25 [00:32<00:41,  2.29s/it, loss: 1.453, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  32%|██▏    | 8/25 [00:32<00:34,  2.05s/it, loss: 1.453, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  32%|██▏    | 8/25 [00:33<00:34,  2.05s/it, loss: 1.473, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  36%|██▌    | 9/25 [00:33<00:30,  1.89s/it, loss: 1.473, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  36%|██▌    | 9/25 [00:35<00:30,  1.89s/it, loss: 1.470, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  40%|██▍   | 10/25 [00:35<00:26,  1.78s/it, loss: 1.470, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  40%|██▍   | 10/25 [00:36<00:26,  1.78s/it, loss: 1.469, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  44%|██▋   | 11/25 [00:36<00:23,  1.70s/it, loss: 1.469, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  44%|██▋   | 11/25 [00:38<00:23,  1.70s/it, loss: 1.462, acc: 0.795, recall: 0.795, f1: 0.795]
评估:  48%|██▉   | 12/25 [00:38<00:21,  1.64s/it, loss: 1.462, acc: 0.795, recall: 0.795, f1: 0.795]
评估:  48%|██▉   | 12/25 [00:39<00:21,  1.64s/it, loss: 1.470, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  52%|███   | 13/25 [00:39<00:19,  1.61s/it, loss: 1.470, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  52%|███   | 13/25 [00:41<00:19,  1.61s/it, loss: 1.445, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  56%|███▎  | 14/25 [00:41<00:17,  1.62s/it, loss: 1.445, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  56%|███▎  | 14/25 [00:42<00:17,  1.62s/it, loss: 1.467, acc: 0.700, recall: 0.700, f1: 0.700]
评估:  60%|███▌  | 15/25 [00:42<00:16,  1.60s/it, loss: 1.467, acc: 0.700, recall: 0.700, f1: 0.700]
评估:  60%|███▌  | 15/25 [00:44<00:16,  1.60s/it, loss: 1.473, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  64%|███▊  | 16/25 [00:44<00:14,  1.58s/it, loss: 1.473, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  64%|███▊  | 16/25 [00:45<00:14,  1.58s/it, loss: 1.472, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  68%|████  | 17/25 [00:45<00:12,  1.58s/it, loss: 1.472, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  68%|████  | 17/25 [00:47<00:12,  1.58s/it, loss: 1.480, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  72%|████▎ | 18/25 [00:47<00:11,  1.59s/it, loss: 1.480, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  72%|████▎ | 18/25 [00:49<00:11,  1.59s/it, loss: 1.475, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  76%|████▌ | 19/25 [00:49<00:09,  1.60s/it, loss: 1.475, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  76%|████▌ | 19/25 [00:50<00:09,  1.60s/it, loss: 1.466, acc: 0.690, recall: 0.690, f1: 0.690]
评估:  80%|████▊ | 20/25 [00:50<00:07,  1.59s/it, loss: 1.466, acc: 0.690, recall: 0.690, f1: 0.690]
评估:  80%|████▊ | 20/25 [00:52<00:07,  1.59s/it, loss: 1.472, acc: 0.815, recall: 0.815, f1: 0.815]
评估:  84%|█████ | 21/25 [00:52<00:06,  1.57s/it, loss: 1.472, acc: 0.815, recall: 0.815, f1: 0.815]
评估:  84%|█████ | 21/25 [00:53<00:06,  1.57s/it, loss: 1.479, acc: 0.715, recall: 0.715, f1: 0.715]
评估:  88%|█████▎| 22/25 [00:53<00:04,  1.56s/it, loss: 1.479, acc: 0.715, recall: 0.715, f1: 0.715]
评估:  88%|█████▎| 22/25 [00:55<00:04,  1.56s/it, loss: 1.465, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  92%|█████▌| 23/25 [00:55<00:03,  1.56s/it, loss: 1.465, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  92%|█████▌| 23/25 [00:56<00:03,  1.56s/it, loss: 1.463, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  96%|█████▊| 24/25 [00:56<00:01,  1.56s/it, loss: 1.463, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  96%|█████▊| 24/25 [00:58<00:01,  1.56s/it, loss: 1.462, acc: 0.810, recall: 0.810, f1: 0.810]
评估: 100%|██████| 25/25 [00:58<00:00,  1.58s/it, loss: 1.462, acc: 0.810, recall: 0.810, f1: 0.810]
评估: 100%|██████| 25/25 [01:00<00:00,  2.41s/it, loss: 1.462, acc: 0.810, recall: 0.810, f1: 0.810]
验证集 - 损失: 1.4681, 准确率: 0.7490, 召回率: 0.7490, F1分数: 0.7490
保存最佳模型，验证准确率: 0.7490, 召回率: 0.7490, F1分数: 0.7490

Epoch 2/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%|                                                                  | 0/25 [00:11<?, ?it/s]
Traceback (most recent call last):
  File "C:\Users\hxq11\Desktop\Project\code\train.py", line 223, in <module>
    train_loss, train_acc, train_recall, train_f1 = train_epoch(model, train_loader, optimizer, device)
  File "C:\Users\hxq11\Desktop\Project\code\utils\utils.py", line 45, in train_epoch
    for batch_idx, (support_x, support_y, query_x, query_y) in enumerate(pbar):
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\tqdm\std.py", line 1181, in __iter__
    for obj in iterable:
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 327, in _Popen
    return Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
OSError: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 126, in _main
    self = reduction.pickle.load(from_parent)
_pickle.UnpicklingError: pickle data was truncated

==================================================
命令执行完成时间: 2025-02-25 19:44:00.294778
返回码: 1
==================================================


==================================================
执行命令: "C:/Users/hxq11/anaconda3/envs/CLIP-LoRA/python.exe" train.py --model all_model --backbone cbam --distance_type euclidean --in_channels 5 --hidden_dim 256 --feature_dim 256 --dropout 0.3 --scheduler cosine --warmup_epochs 5 --warmup_start_lr 1e-6 --lr 0.001
开始时间: 2025-02-25 19:44:02.298520
==================================================

使用设备: cuda
使用模型: all_model
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

训练集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 746 个样本
类别 1: 746 个样本
类别 2: 746 个样本
类别 3: 746 个样本
类别 4: 746 个样本
类别 5: 746 个样本
类别 6: 746 个样本
类别 7: 746 个样本
正在加载文件夹: data/h5data

原始标签形状: (7464, 8)
标签示例（前5个）:
[[1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0.]]

标签名称: ['NORMAL' 'SC' 'HR' 'RB' 'BF-I' 'BF-O' 'BF-R' 'BF-C']

数据集划分情况:
类别 0:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 1:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 2:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 3:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 4:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 5:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 6:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本
类别 7:
  - 总样本数: 933
  - 训练集: 746 个样本
  - 测试集: 187 个样本

测试集信息:
包含的类别: [0, 1, 2, 3, 4, 5, 6, 7]
类别 0: 187 个样本
类别 1: 187 个样本
类别 2: 187 个样本
类别 3: 187 个样本
类别 4: 187 个样本
类别 5: 187 个样本
类别 6: 187 个样本
类别 7: 187 个样本

正在检查数据泄露...
数据集检查通过，未发现数据泄露。

Epoch 1/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%| | 0/25 [00:55<?, ?it/s, loss: 1.377, acc: 0.750, recall: 0.750, f1: 0.750, lr: 1.00e-06]
训练:   4%| | 1/25 [00:55<22:12, 55.53s/it, loss: 1.377, acc: 0.750, recall: 0.750, f1: 0.750, lr: 1
训练:   4%| | 1/25 [01:09<22:12, 55.53s/it, loss: 1.404, acc: 0.665, recall: 0.665, f1: 0.665, lr: 1
训练:   8%| | 2/25 [01:09<11:51, 30.95s/it, loss: 1.404, acc: 0.665, recall: 0.665, f1: 0.665, lr: 1
训练:   8%| | 2/25 [01:27<11:51, 30.95s/it, loss: 1.402, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1
训练:  12%| | 3/25 [01:27<09:17, 25.32s/it, loss: 1.402, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1
训练:  12%| | 3/25 [01:40<09:17, 25.32s/it, loss: 1.394, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:  16%|▏| 4/25 [01:40<07:08, 20.39s/it, loss: 1.394, acc: 0.675, recall: 0.675, f1: 0.675, lr: 1
训练:  16%|▏| 4/25 [01:53<07:08, 20.39s/it, loss: 1.416, acc: 0.735, recall: 0.735, f1: 0.735, lr: 1
训练:  20%|▏| 5/25 [01:53<05:54, 17.73s/it, loss: 1.416, acc: 0.735, recall: 0.735, f1: 0.735, lr: 1
训练:  20%|▏| 5/25 [02:06<05:54, 17.73s/it, loss: 1.401, acc: 0.775, recall: 0.775, f1: 0.775, lr: 1
训练:  24%|▏| 6/25 [02:06<05:05, 16.08s/it, loss: 1.401, acc: 0.775, recall: 0.775, f1: 0.775, lr: 1
训练:  24%|▏| 6/25 [02:19<05:05, 16.08s/it, loss: 1.401, acc: 0.655, recall: 0.655, f1: 0.655, lr: 1
训练:  28%|▎| 7/25 [02:19<04:30, 15.02s/it, loss: 1.401, acc: 0.655, recall: 0.655, f1: 0.655, lr: 1
训练:  28%|▎| 7/25 [02:32<04:30, 15.02s/it, loss: 1.400, acc: 0.700, recall: 0.700, f1: 0.700, lr: 1
训练:  32%|▎| 8/25 [02:32<04:04, 14.37s/it, loss: 1.400, acc: 0.700, recall: 0.700, f1: 0.700, lr: 1
训练:  32%|▎| 8/25 [02:45<04:04, 14.37s/it, loss: 1.392, acc: 0.740, recall: 0.740, f1: 0.740, lr: 1
训练:  36%|▎| 9/25 [02:45<03:43, 13.99s/it, loss: 1.392, acc: 0.740, recall: 0.740, f1: 0.740, lr: 1
训练:  36%|▎| 9/25 [02:58<03:43, 13.99s/it, loss: 1.404, acc: 0.725, recall: 0.725, f1: 0.725, lr: 1
训练:  40%|▍| 10/25 [02:58<03:25, 13.70s/it, loss: 1.404, acc: 0.725, recall: 0.725, f1: 0.725, lr: 
训练:  40%|▍| 10/25 [03:11<03:25, 13.70s/it, loss: 1.404, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  44%|▍| 11/25 [03:11<03:08, 13.47s/it, loss: 1.404, acc: 0.710, recall: 0.710, f1: 0.710, lr: 
训练:  44%|▍| 11/25 [03:25<03:08, 13.47s/it, loss: 1.381, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  48%|▍| 12/25 [03:25<02:57, 13.68s/it, loss: 1.381, acc: 0.680, recall: 0.680, f1: 0.680, lr: 
训练:  48%|▍| 12/25 [03:56<02:57, 13.68s/it, loss: 1.405, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  52%|▌| 13/25 [03:56<03:45, 18.75s/it, loss: 1.405, acc: 0.690, recall: 0.690, f1: 0.690, lr: 
训练:  52%|▌| 13/25 [04:55<03:45, 18.75s/it, loss: 1.399, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  56%|▌| 14/25 [04:55<05:42, 31.12s/it, loss: 1.399, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  56%|▌| 14/25 [05:30<05:42, 31.12s/it, loss: 1.378, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  60%|▌| 15/25 [05:30<05:21, 32.18s/it, loss: 1.378, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  60%|▌| 15/25 [05:45<05:21, 32.18s/it, loss: 1.407, acc: 0.650, recall: 0.650, f1: 0.650, lr: 
训练:  64%|▋| 16/25 [05:45<04:03, 27.03s/it, loss: 1.407, acc: 0.650, recall: 0.650, f1: 0.650, lr: 
训练:  64%|▋| 16/25 [06:03<04:03, 27.03s/it, loss: 1.407, acc: 0.660, recall: 0.660, f1: 0.660, lr: 
训练:  68%|▋| 17/25 [06:03<03:13, 24.22s/it, loss: 1.407, acc: 0.660, recall: 0.660, f1: 0.660, lr: 
训练:  68%|▋| 17/25 [06:18<03:13, 24.22s/it, loss: 1.400, acc: 0.665, recall: 0.665, f1: 0.665, lr: 
训练:  72%|▋| 18/25 [06:18<02:29, 21.37s/it, loss: 1.400, acc: 0.665, recall: 0.665, f1: 0.665, lr: 
训练:  72%|▋| 18/25 [06:32<02:29, 21.37s/it, loss: 1.391, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  76%|▊| 19/25 [06:32<01:55, 19.25s/it, loss: 1.391, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  76%|▊| 19/25 [06:47<01:55, 19.25s/it, loss: 1.407, acc: 0.665, recall: 0.665, f1: 0.665, lr: 
训练:  80%|▊| 20/25 [06:47<01:29, 17.92s/it, loss: 1.407, acc: 0.665, recall: 0.665, f1: 0.665, lr: 
训练:  80%|▊| 20/25 [07:01<01:29, 17.92s/it, loss: 1.405, acc: 0.670, recall: 0.670, f1: 0.670, lr: 
训练:  84%|▊| 21/25 [07:01<01:06, 16.71s/it, loss: 1.405, acc: 0.670, recall: 0.670, f1: 0.670, lr: 
训练:  84%|▊| 21/25 [07:14<01:06, 16.71s/it, loss: 1.390, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  88%|▉| 22/25 [07:14<00:47, 15.81s/it, loss: 1.390, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  88%|▉| 22/25 [07:29<00:47, 15.81s/it, loss: 1.395, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  92%|▉| 23/25 [07:29<00:31, 15.57s/it, loss: 1.395, acc: 0.695, recall: 0.695, f1: 0.695, lr: 
训练:  92%|▉| 23/25 [07:43<00:31, 15.57s/it, loss: 1.400, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  96%|▉| 24/25 [07:43<00:14, 14.91s/it, loss: 1.400, acc: 0.700, recall: 0.700, f1: 0.700, lr: 
训练:  96%|▉| 24/25 [07:55<00:14, 14.91s/it, loss: 1.393, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练: 100%|█| 25/25 [07:55<00:00, 14.27s/it, loss: 1.393, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练: 100%|█| 25/25 [07:58<00:00, 19.13s/it, loss: 1.393, acc: 0.640, recall: 0.640, f1: 0.640, lr: 
训练集 - 损失: 1.3981, 准确率: 0.6944, 召回率: 0.6944, F1分数: 0.6944

评估:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
评估:   0%|               | 0/25 [00:23<?, ?it/s, loss: 1.467, acc: 0.715, recall: 0.715, f1: 0.715]
评估:   4%|▎      | 1/25 [00:23<09:28, 23.69s/it, loss: 1.467, acc: 0.715, recall: 0.715, f1: 0.715]
评估:   4%|▎      | 1/25 [00:25<09:28, 23.69s/it, loss: 1.449, acc: 0.780, recall: 0.780, f1: 0.780]
评估:   8%|▌      | 2/25 [00:25<04:04, 10.65s/it, loss: 1.449, acc: 0.780, recall: 0.780, f1: 0.780]
评估:   8%|▌      | 2/25 [00:26<04:04, 10.65s/it, loss: 1.461, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  12%|▊      | 3/25 [00:26<02:22,  6.48s/it, loss: 1.461, acc: 0.695, recall: 0.695, f1: 0.695]
评估:  12%|▊      | 3/25 [00:28<02:22,  6.48s/it, loss: 1.463, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  16%|█      | 4/25 [00:28<01:34,  4.52s/it, loss: 1.463, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  16%|█      | 4/25 [00:29<01:34,  4.52s/it, loss: 1.431, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  20%|█▍     | 5/25 [00:29<01:09,  3.47s/it, loss: 1.431, acc: 0.730, recall: 0.730, f1: 0.730]
评估:  20%|█▍     | 5/25 [00:31<01:09,  3.47s/it, loss: 1.461, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  24%|█▋     | 6/25 [00:31<00:53,  2.81s/it, loss: 1.461, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  24%|█▋     | 6/25 [00:32<00:53,  2.81s/it, loss: 1.454, acc: 0.715, recall: 0.715, f1: 0.715]
评估:  28%|█▉     | 7/25 [00:32<00:42,  2.39s/it, loss: 1.454, acc: 0.715, recall: 0.715, f1: 0.715]
评估:  28%|█▉     | 7/25 [00:34<00:42,  2.39s/it, loss: 1.436, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  32%|██▏    | 8/25 [00:34<00:35,  2.12s/it, loss: 1.436, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  32%|██▏    | 8/25 [00:35<00:35,  2.12s/it, loss: 1.419, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  36%|██▌    | 9/25 [00:35<00:30,  1.93s/it, loss: 1.419, acc: 0.765, recall: 0.765, f1: 0.765]
评估:  36%|██▌    | 9/25 [00:37<00:30,  1.93s/it, loss: 1.442, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  40%|██▍   | 10/25 [00:37<00:27,  1.81s/it, loss: 1.442, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  40%|██▍   | 10/25 [00:39<00:27,  1.81s/it, loss: 1.452, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  44%|██▋   | 11/25 [00:39<00:24,  1.73s/it, loss: 1.452, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  44%|██▋   | 11/25 [00:40<00:24,  1.73s/it, loss: 1.439, acc: 0.670, recall: 0.670, f1: 0.670]
评估:  48%|██▉   | 12/25 [00:40<00:21,  1.67s/it, loss: 1.439, acc: 0.670, recall: 0.670, f1: 0.670]
评估:  48%|██▉   | 12/25 [00:42<00:21,  1.67s/it, loss: 1.458, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  52%|███   | 13/25 [00:42<00:19,  1.63s/it, loss: 1.458, acc: 0.775, recall: 0.775, f1: 0.775]
评估:  52%|███   | 13/25 [00:43<00:19,  1.63s/it, loss: 1.467, acc: 0.685, recall: 0.685, f1: 0.685]
评估:  56%|███▎  | 14/25 [00:43<00:17,  1.59s/it, loss: 1.467, acc: 0.685, recall: 0.685, f1: 0.685]
评估:  56%|███▎  | 14/25 [00:45<00:17,  1.59s/it, loss: 1.453, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  60%|███▌  | 15/25 [00:45<00:15,  1.57s/it, loss: 1.453, acc: 0.755, recall: 0.755, f1: 0.755]
评估:  60%|███▌  | 15/25 [00:46<00:15,  1.57s/it, loss: 1.461, acc: 0.700, recall: 0.700, f1: 0.700]
评估:  64%|███▊  | 16/25 [00:46<00:13,  1.55s/it, loss: 1.461, acc: 0.700, recall: 0.700, f1: 0.700]
评估:  64%|███▊  | 16/25 [00:48<00:13,  1.55s/it, loss: 1.439, acc: 0.740, recall: 0.740, f1: 0.740]
评估:  68%|████  | 17/25 [00:48<00:12,  1.54s/it, loss: 1.439, acc: 0.740, recall: 0.740, f1: 0.740]
评估:  68%|████  | 17/25 [00:49<00:12,  1.54s/it, loss: 1.443, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  72%|████▎ | 18/25 [00:49<00:10,  1.54s/it, loss: 1.443, acc: 0.790, recall: 0.790, f1: 0.790]
评估:  72%|████▎ | 18/25 [00:51<00:10,  1.54s/it, loss: 1.465, acc: 0.710, recall: 0.710, f1: 0.710]
评估:  76%|████▌ | 19/25 [00:51<00:09,  1.53s/it, loss: 1.465, acc: 0.710, recall: 0.710, f1: 0.710]
评估:  76%|████▌ | 19/25 [00:52<00:09,  1.53s/it, loss: 1.451, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  80%|████▊ | 20/25 [00:52<00:07,  1.53s/it, loss: 1.451, acc: 0.750, recall: 0.750, f1: 0.750]
评估:  80%|████▊ | 20/25 [00:54<00:07,  1.53s/it, loss: 1.458, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  84%|█████ | 21/25 [00:54<00:06,  1.52s/it, loss: 1.458, acc: 0.725, recall: 0.725, f1: 0.725]
评估:  84%|█████ | 21/25 [00:55<00:06,  1.52s/it, loss: 1.449, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  88%|█████▎| 22/25 [00:55<00:04,  1.51s/it, loss: 1.449, acc: 0.720, recall: 0.720, f1: 0.720]
评估:  88%|█████▎| 22/25 [00:57<00:04,  1.51s/it, loss: 1.453, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  92%|█████▌| 23/25 [00:57<00:03,  1.52s/it, loss: 1.453, acc: 0.780, recall: 0.780, f1: 0.780]
评估:  92%|█████▌| 23/25 [00:58<00:03,  1.52s/it, loss: 1.481, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  96%|█████▊| 24/25 [00:58<00:01,  1.53s/it, loss: 1.481, acc: 0.745, recall: 0.745, f1: 0.745]
评估:  96%|█████▊| 24/25 [01:00<00:01,  1.53s/it, loss: 1.451, acc: 0.740, recall: 0.740, f1: 0.740]
评估: 100%|██████| 25/25 [01:00<00:00,  1.52s/it, loss: 1.451, acc: 0.740, recall: 0.740, f1: 0.740]
评估: 100%|██████| 25/25 [01:01<00:00,  2.44s/it, loss: 1.451, acc: 0.740, recall: 0.740, f1: 0.740]
验证集 - 损失: 1.4520, 准确率: 0.7390, 召回率: 0.7390, F1分数: 0.7390
保存最佳模型，验证准确率: 0.7390, 召回率: 0.7390, F1分数: 0.7390

Epoch 2/80

训练:   0%|                                                                  | 0/25 [00:00<?, ?it/s]
训练:   0%|                                                                  | 0/25 [00:32<?, ?it/s]
Traceback (most recent call last):
  File "C:\Users\hxq11\Desktop\Project\code\train.py", line 223, in <module>
    train_loss, train_acc, train_recall, train_f1 = train_epoch(model, train_loader, optimizer, device)
  File "C:\Users\hxq11\Desktop\Project\code\utils\utils.py", line 45, in train_epoch
    for batch_idx, (support_x, support_y, query_x, query_y) in enumerate(pbar):
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\tqdm\std.py", line 1181, in __iter__
    for obj in iterable:
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\context.py", line 327, in _Popen
    return Popen(process_obj)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
OSError: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "C:\Users\hxq11\anaconda3\envs\CLIP-LoRA\lib\multiprocessing\spawn.py", line 126, in _main
    self = reduction.pickle.load(from_parent)
_pickle.UnpicklingError: pickle data was truncated

==================================================
命令执行完成时间: 2025-02-25 19:53:52.969578
返回码: 1
==================================================


==================================================
实验组结束时间: 2025-02-25 19:53:52.976578
